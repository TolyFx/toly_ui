class TableDemo3 extends StatelessWidget {
  const TableDemo3({super.key});

  @override
  Widget build(BuildContext context) {
    List<Map<String, dynamic>> sourceData = const [
      {
        'key': '1',
        'name': 'John Brown',
        'age': 32,
        'address': 'New York No. 1 Lake Park, New York No. 1 Lake Park',
        'tags': ['Developer', 'Designer'],
      },
      {
        'key': '2',
        'name': 'Jim Green',
        'age': 42,
        'address': 'London No. 1 Lake Park',
        'tags': ['Manager'],
      },
      {
        'key': '3',
        'name': 'Joe Black',
        'age': 32,
        'address': 'Sydney No. 1 Lake Park',
        'tags': ['Developer', 'Tester', 'Designer'],
      },
    ];

    return TolyTable<_ColumnWidthData>.source(
      data: sourceData,
      converter: _ColumnWidthData.fromMap,
      fields: [
        FieldSpec<_ColumnWidthData>(
          key: 'name',
          header: const FieldHeader(title: 'Name'),
          constraint: const FieldConstraint(
            width: 120,
            alignment: Alignment.centerLeft,
          ),
          builder: (ctx) => Text(
            ctx.data.name,
            style: const TextStyle(color: Colors.blue, fontWeight: FontWeight.w500),
          ),
        ),
        FieldSpec<_ColumnWidthData>(
          key: 'age',
          header: const FieldHeader(title: 'Age'),
          constraint: const FieldConstraint(
            width: 80,
            alignment: Alignment.center,
          ),
          builder: (ctx) => Text(
            '${ctx.data.age}',
            textAlign: TextAlign.center,
          ),
        ),
        FieldSpec<_ColumnWidthData>(
          key: 'address',
          header: const FieldHeader(title: 'Address'),
          constraint: const FieldConstraint(
            minWidth: 200,
            maxWidth: 400,
            alignment: Alignment.centerLeft,
          ),
          builder: (ctx) => Text(
            ctx.data.address,
            maxLines: 2,
            overflow: TextOverflow.ellipsis,
          ),
        ),
        FieldSpec<_ColumnWidthData>(
          key: 'tags',
          header: const FieldHeader(title: 'Tags'),
          constraint: const FieldConstraint(
            width: 200,
            alignment: Alignment.centerLeft,
          ),
          builder: (ctx) => Wrap(
            spacing: 4,
            runSpacing: 4,
            children: ctx.data.tags.map((tag) => Chip(
              label: Text(tag, style: const TextStyle(fontSize: 12)),
              padding: EdgeInsets.zero,
              materialTapTargetSize: MaterialTapTargetSize.shrinkWrap,
            )).toList(),
          ),
        ),
      ],
      appearance: const SheetAppearance(
        showBorder: true,
        layoutMode: LayoutMode.fixed,
      ),
    );
  }
}

class _ColumnWidthData {
  final String key;
  final String name;
  final int age;
  final String address;
  final List<String> tags;

  const _ColumnWidthData({
    required this.key,
    required this.name,
    required this.age,
    required this.address,
    required this.tags,
  });

  factory _ColumnWidthData.fromMap(Map<String, dynamic> map) {
    return _ColumnWidthData(
      key: map['key'] as String,
      name: map['name'] as String,
      age: map['age'] as int,
      address: map['address'] as String,
      tags: (map['tags'] as List).cast<String>(),
    );
  }
}
